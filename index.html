<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AudioVerse - Modern Audiobook Experience</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Playfair+Display:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        /* CSS yang sama seperti sebelumnya */
        :root {
            --primary-color: #f6d365;
            --secondary-color: #fda085;
            --background-start: #1a2a6c;
            --background-end: #4facfe;
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            --text-color: #fff;
            --dark-text: #000;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Montserrat', sans-serif;
        }

        body {
            background: linear-gradient(135deg, var(--background-start), var(--background-end));
            color: var(--text-color);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            padding: 30px 0;
        }

        header h1 {
            font-family: 'Playfair Display', serif;
            font-size: clamp(2.5rem, 5vw, 3.5rem);
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        header p {
            font-size: clamp(1rem, 2vw, 1.2rem);
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 30px;
        }

        @media (max-width: 900px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .player-section,
        .form-section {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: var(--glass-shadow);
        }

        .section-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
        }

        .player-container {
            text-align: center;
        }

        .book-cover {
            width: 250px;
            height: 250px;
            border-radius: 15px;
            object-fit: cover;
            margin-bottom: 20px;
            box-shadow: 0 15px 25px rgba(0, 0, 0, 0.4);
            transition: transform 0.3s ease;
        }

        .book-cover:hover {
            transform: scale(1.03);
        }

        .book-title {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .book-author {
            font-size: 1.1rem;
            opacity: 0.8;
            margin-bottom: 20px;
        }

        .player-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
        }

        .control-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .text-display {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 20px;
            height: 300px;
            overflow-y: auto;
            margin-top: 20px;
            text-align: left;
            font-size: 1.1rem;
            line-height: 1.6;
        }

        .highlight {
            background: linear-gradient(120deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: var(--dark-text);
            padding: 2px 4px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }
        
        /* --- Perubahan untuk scroll horizontal --- */
        .cards-section {
            overflow: hidden; /* Mencegah scrollbar di section itu sendiri */
        }
        
        .audiobook-cards-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }

        .scroll-btn {
            background: none;
            border: none;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            padding: 10px;
            opacity: 0.7;
            transition: opacity 0.3s ease;
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            z-index: 10;
        }

        .scroll-btn:hover {
            opacity: 1;
        }
        
        #scroll-left {
            left: -15px;
        }

        #scroll-right {
            right: -15px;
        }

        .audiobook-cards {
            display: flex;
            gap: 20px;
            overflow-x: auto;
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
            padding: 20px 0;
            margin-top: 20px;
        }

        /* Sembunyikan scrollbar bawaan */
        .audiobook-cards::-webkit-scrollbar {
            display: none;
        }

        .audiobook-cards {
            -ms-overflow-style: none; /* IE and Edge */
            scrollbar-width: none; /* Firefox */
        }
        
        .card {
            min-width: 250px; /* Menentukan lebar minimum kartu */
            max-width: 250px;
            background: var(--glass-bg);
            border-radius: 15px;
            overflow: hidden;
            flex-shrink: 0;
            transition: transform 0.4s ease, box-shadow 0.4s ease;
            transform-style: preserve-3d;
            perspective: 1000px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            cursor: pointer;
        }

        .card:hover {
            transform: translateY(-10px) rotateX(5deg);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4);
        }

        .card-img {
            width: 100%;
            height: 180px;
            object-fit: cover;
        }

        .card-content {
            padding: 15px;
        }

        .card-title {
            font-size: 1.2rem;
            margin-bottom: 8px;
            color: var(--primary-color);
        }

        .card-author {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 15px;
        }

        .card-duration {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
        }

        .form-section {
            margin-top: 30px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: none;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
        }

        .form-group textarea {
            height: 120px;
            resize: vertical;
        }

        .submit-btn {
            background: linear-gradient(120deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: var(--dark-text);
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .submit-btn:hover {
            transform: translateY(-3px);
        }

        footer {
            text-align: center;
            padding: 30px 0;
            margin-top: 50px;
            opacity: 0.7;
        }

        .progress-container {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            margin: 15px 0;
            overflow: hidden;
            cursor: pointer;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(120deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            border-radius: 4px;
            width: 0%;
            transition: width 0.3s ease;
        }

        .time-display {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 0.9rem;
            opacity: 0.8;
        }

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.4);
        }
        
        .error-message {
            background: rgba(255, 80, 80, 0.15);
            border-left: 4px solid #ff5252;
            padding: 12px;
            border-radius: 6px;
            margin: 10px 0;
        }
        
        .error-message p {
            margin: 5px 0;
        }
        
        .transcript-sentence {
            margin: 10px 0;
            padding: 5px;
            transition: all 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>AudioVerse</h1>
            <p>Immerse yourself in captivating stories with our premium audiobook collection</p>
        </header>

        <div class="main-content">
            <section class="player-section">
                <h2 class="section-title">Now Playing</h2>
                <div class="player-container">
                    <img src="https://images.unsplash.com/photo-1629992101753-56d196c8aabb?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=600&q=80" alt="Book Cover" class="book-cover" id="book-cover">
                    <h3 class="book-title" id="current-book-title">The Silent Echo</h3>
                    <p class="book-author" id="current-book-author">By Jonathan Miles</p>

                    <audio id="audio-element" style="display: none;"></audio>

                    <div class="progress-container" id="progress-container">
                        <div class="progress-bar" id="progress-bar"></div>
                    </div>

                    <div class="time-display">
                        <span id="current-time">0:00</span>
                        <span id="duration">0:00</span>
                    </div>

                    <div class="player-controls">
                        <button class="control-btn" id="prev-btn" title="Previous"><i class="fas fa-step-backward"></i></button>
                        <button class="control-btn" id="rewind-btn" title="Rewind 10s"><i class="fas fa-undo-alt"></i></button>
                        <button class="control-btn" id="play-pause-btn" title="Play/Pause"><i class="fas fa-play"></i></button>
                        <button class="control-btn" id="forward-btn" title="Forward 10s"><i class="fas fa-redo-alt"></i></button>
                        <button class="control-btn" id="next-btn" title="Next"><i class="fas fa-step-forward"></i></button>
                    </div>

                    <div class="text-display" id="text-display">
                        <p>Loading transcript...</p>
                    </div>
                </div>
            </section>

            <section class="cards-section">
                <h2 class="section-title">Audiobook Collection</h2>
                <div class="audiobook-cards-wrapper">
                    <button class="scroll-btn" id="scroll-left"><i class="fas fa-chevron-left"></i></button>
                    <div class="audiobook-cards" id="audiobook-cards">
                        <!-- Cards will be populated dynamically -->
                    </div>
                    <button class="scroll-btn" id="scroll-right"><i class="fas fa-chevron-right"></i></button>
                </div>
            </section>
        </div>

        <section class="form-section">
            <h2 class="section-title">Request an Audiobook</h2>
            <form id="audiobook-form">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="title">Book Title</label>
                        <input type="text" id="title" name="title" required>
                    </div>
                    <div class="form-group">
                        <label for="author">Author</label>
                        <input type="text" id="author" name="author" required>
                    </div>
                    <div class="form-group">
                        <label for="genre">Genre</label>
                        <select id="genre" name="genre">
                            <option value="fiction">Fiction</option>
                            <option value="non-fiction">Non-Fiction</option>
                            <option value="sci-fi">Science Fiction</option>
                            <option value="fantasy">Fantasy</option>
                            <option value="mystery">Mystery</option>
                            <option value="biography">Biography</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="email">Your Email</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="message">Additional Notes</label>
                    <textarea id="message" name="message"></textarea>
                </div>
                <button type="submit" class="submit-btn">Submit Request</button>
            </form>
        </section>

        <footer>
            <p>&copy; 2023 AudioVerse. All rights reserved.</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Fungsi untuk mengonversi transkrip dengan format timestamp ke format yang dibutuhkan
            function parseTimestampTranscript(transcriptText) {
                const lines = transcriptText.trim().split('\n');
                const segments = [];
                
                for (let i = 0; i < lines.length; i += 2) {
                    if (i + 1 >= lines.length) break;
                    
                    const timestamp = lines[i].trim();
                    let text = lines[i + 1].trim();
                    
                    if (!timestamp || !text) continue;
                    
                    // Konversi timestamp mm:ss ke detik
                    const [minutes, seconds] = timestamp.split(':').map(Number);
                    const start = minutes * 60 + seconds;
                    
                    // Tentukan end time (ambil dari timestamp berikutnya)
                    let end;
                    if (i + 2 < lines.length && lines[i + 2].includes(':')) {
                        const nextTimestamp = lines[i + 2].trim();
                        const [nextMinutes, nextSeconds] = nextTimestamp.split(':').map(Number);
                        end = nextMinutes * 60 + nextSeconds;
                    } else {
                        // Untuk segmen terakhir, tambahkan durasi berdasarkan panjang teks
                        end = start + (text.length * 0.08);
                    }
                    
                    // Perbaiki beberapa kesalahan pengetikan umum
                    text = text
                        .replace(/ต่างทากัน/g, 'ต่างพากัน')
                        .replace(/กะรอก/g, 'กระรอก')
                        .replace(/ชีสทองคํา/g, 'ชีสทองคำ')
                        .replace(/ตุ๊กใจ/g, 'ตกใจ')
                        .replace(/เจ้านก/g, 'เจ้าหนู')
                        .replace(/ยืมกว้าง/g, 'ยิ้มกว้าง')
                        .replace(/ทํา/g, 'ทำ')
                        .replace(/มินาคิด/g, 'ไม่น่าคิด')
                        .replace(/ช้าวัน/g, 'เช้าวัน');
                    
                    segments.push({
                        start: start,
                        end: end,
                        text: text
                    });
                }
                
                return segments;
            }

            // Transkrip asli dengan format timestamp
            const rawTranscript = `00:00
วันนี้เสนอตอน 

00:02
เจ้าหนูกับเรื่องไม่จริง ในหมู่บ้านสัตว์ตัวจิ๋ว 

00:08
มีหนูตัวเล็กน่ารัก มันมีนิสัยร่าเริงชอบเล่น 

00:13
ชอบพูด และบางทีก็ชอบแต่งเรื่องให้ดูน่าตื่นเต้น 

00:18
วันหนึ่ง เจ้าหนูวิ่งมาหาเพื่อนเพื่อน แล้วร้องว่า 

00:23
มาดูนี่แล้ว ช้างเป็นได้ ฉันเห็นมันลอยอยู่บนฟ้า 

00:27
เพื่อน ๆ ตกใจ ต่างพากันวิ่งมาดู จริงเหรอ ช้างบินได้เหรอ แต่มันไม่จริงเลย 

00:36
เจ้าหนูหัวเราะ ฮ่า ฮ่า ฮ่า แล้วพูดขึ้นว่า ช้างที่ไหนจะบินได้ ไม่มีหรอก ฉันพูดเล่น 

00:43
เพื่อน ๆ ต่างทากันบ่นเจ้าหนู แล้วแยกย้ายกันกลับบ้าน 

00:48
ช้าวันต่อมา เจ้าหนูเจอกับกะรอก แล้วบอกกะรอกไปว่า 

00:55
ฉันมีชีสทองคําซ่อนไว้ใต้ดิน อย่าบอกใครนะ แต่ฉันจะให้เธอ 

01:00
กะรอกดีใจมาก และขุดดินเพื่อที่จะหาชีสทองคําจนถึงเย็น 

01:06
แต่ก็หาไม่เจอสักที เจ้าหนูเดินผลั่นกลับมาเจอแล้วถามว่า 

01:12
มาขุดอะไรที่นี่เหรอ กะรอกตอบไปว่า 

01:16
ก็มาขุดชีสทองคังที่เธอบอกฉันไง เจ้าหนูหัวเราะชอบใจและตอบไปว่า 

01:22
ฉันแค่ล้อจะเล่นมินาคิดจริงเลย กระรอกได้ยินอย่างนั้นก็โกรธมาก 

01:27
แล้วเดินจากไปไม่คุยกับเจ้าหนูต่อ หลายวันผ่านไปเพื่อนเพื่อนเริ่มไม่เชื่อสิ่งที่เจ้าหนูพูดแล้ว 

01:36
เธอชอบพูดไม่จริง ใช่ ฟังแล้วก็ไม่รู้จะเชื่อดีไหม 

01:42
แล้ววันหนึ่ง ตอนที่เจ้าหนูกําลังเล่นคุณเดียวที่หลังพุ่มไม้ 

01:46
เธอเห็นงูตัวใหญ่เลื้อยอยู่ไก่มาก เจ้าหนูตุ๊กใจสุดขีด 

01:51
งง งง ช่วยด้วย เธอร้องเสียงดังสุดเสียง 

01:56
แต่เพื่อนเพื่อนได้ยินแล้ว กลับพูดว่า คงแต่งเรื่องอีกแล้วแน่เลย 

02:01
เราไม่อยากโดนทะลอกอีกแล้วล่ะ ไม่มีใครมาช่วยเจ้าหนูเลย 

02:07
แต่โชคดีที่เจ้านกบินผ่านมาเจอพอดี จึงไล่งูให้ทันก่อนที่เจ้านกจะโดนกัด 

02:14
นกพูดว่า ปลดภัยแล้วนะ แล้วทําไมไม่มีใครมาช่วยเธอเลยล่ะ 

02:19
เพื่อนก็อยู่กันตั้งเยอะ เจ้านกก้มหน้า ตอบไปว่า 

02:25
ไม่มีใครเชื่อฉันเลย เพราะฉันชอบโกหกพวกเขา 

02:29
หลังเหตุการณ์วันนั้น เจ้านกรู้สึกเสียใจมาก 

02:34
เธอเข้าไปหาเพื่อนเพื่อน แล้วพูดว่า เมื่อวานฉันเจองูจริงจริง 

02:40
แต่ไม่มีใครเชื่อเลย ฉันรู้แล้วว่าการพูดไม่จริง 

02:44
ทําให้เพื่อนไม่ไว้ใจ ฉันขอโทษนะ 

02:48
เพื่อนเพื่อนมองหน้ากัน แล้วพูดว่า ถ้าเธอพูดความจริงแบบนี้ 

02:53
ต่อไปเราก็จะให้อภัยเราเป็นเพื่อนกันเหมือนเดิม เจ้าหนูยืมกว้าง 

02:59
สีหน้ามีความสุขขึ้นมาทันที ตั้งแต่นั้นมา เจ้าหนูก็พูดความจริงเสมอ 

03:05
ไม่แต่งเรื่องอีก และได้กลับมาเป็นเพื่อนรักกับทุกคนอีกครั้ง 

03:10
นิทานเรื่องนี้สอนให้รู้ว่า การพูดโกหกอาจดูสนุกในตอนแรก 

03:17
แต่ถ้าเราพูดไม่จริงบ่อยบ่อย สุดท้ายจะไม่มีใครเชื่อเราเลย 

03:23
เพราะฉะนั้นเราควรพูดความจริงอยู่เสมอ เพื่อให้คนไว้ใจและรักเรานะเด็กเด็ก 

03:30
ติดตามนิทานเรื่องใหม่ใหม่ได้ที่ช่องบ้านนิทานเด็กดี 

03:36
และอย่าลืมกดติดตามกดไลค์กดแชร์ที่ทานสนุกสนุกข้อคิดดีดีไว้ด้วยนะครับ`;

            // Data transkrip langsung di-embed di kode
            const transcripts = {
                1: [
                    { start: 0.0, end: 47.0, text: "วันนี้เสนอตอน เจ้าหนูกับเรื่องไม่จริง ในหมู่บ้านสัตว์ตัวจิ๋ว มีหนูตัวเล็กน่ารัก มันมีนิสัยร่าเริงชอบเล่น ชอบพูด และบางทีก็ชอบแต่งเรื่องให้ดูน่าตื่นเต้น วันหนึ่ง เจ้าหนูวิ่งมาหาเพื่อน ๆ แล้วร้องว่า \"มาดูนี่เร็ว! ช้างบินได้! ฉันเห็นมันลอยอยู่บนฟ้า!\" เพื่อน ๆ ตกใจต่างพากันวิ่งมาดู \"จริงเหรอ?! ช้างบินได้เหรอ?!\" แต่มันไม่จริงเลย... เจ้าหนูหัวเราะ ฮ่าๆๆ และพูดขึ้นว่า \"ช้างที่ไหนจะบินได้ไม่มีหรอก..ฉันพูดเล่น\" เพื่อนๆ ต่างพากันบ่นเจ้าหนู แล้วแยกย้ายกันกลับบ้าน เช้าวันต่อมา เจ้าหนูเจอกับกระรอก แล้วบอกกระรอกไปว่า" },
                    { start: 55.0, end: 97.0, text: "ฉันมีชีสทองคำซ่อนไว้ใต้ดิน อย่าบอกใครนะ แต่ฉันจะให้เธอ! กระรอกดีใจมาก และขุดดินเพื่อที่จะหาชีสทองคำจนถึงเย็น แต่ก็หาไม่เจอสักที เจ้าหนูเดินผ่านกลับมาเจอแล้วถามว่า มาขุดอะไรที่นี่หรอ กระรอกตอบไปว่า ก็มาขุดชีสทองคำที่เธอบอกให้ฉันไง เจ้าหนูหัวเราะชอบใจและตอบไปว่า ฉันแค่ล้อเธอเล่น ไม่น่าคิดจริงจังเลย กระรอกได้ยินดังนั้นก็โกรธมาก และเดินจากไปไม่คุยกับเจ้าหนูต่อ หลายวันผ่านไป เพื่อน ๆ เริ่มไม่เชื่อสิ่งที่เจ้าหนูพูดแล้ว เธอชอบพูดไม่จริง... ใช่ ฟังแล้วก็ไม่รู้จะเชื่อดีไหม… แล้ววันหนึ่ง ตอนที่เจ้าหนูกำลังเล่นคนเดียวที่หลังพุ่มไม้" },
                    { start: 107.0, end: 148.0, text: "เธอเห็น งูตัวใหญ่ เลื้อยอยู่ใกล้มาก! เจ้าหนูตกใจสุดขีด \"งู! งู! ช่วยด้วย!!\" เธอร้องเสียงดังสุดเสียง แต่เพื่อน ๆ ได้ยินแล้วกลับพูดว่า \"คงแต่งเรื่องอีกแล้วแน่เลย…\" \"เราไม่อยากโดนเธอหลอกอีกแล้วล่ะ…\" ไม่มีใครมาช่วยเจ้าหนูเลย แต่โชคดีที่เจ้านกบินผ่านมาเจอพอดี จึงไล่งูให้ทันกันก่อนที่เจ้าหนูจะโดนกัด นกพูดว่า \"ปลอดภัยแล้วนะ\" \"แล้วทำไมไม่มีใครมาช่วยเธอเลยล่ะ เพื่อนก็อยู่กันตั้งเยอะ\" เจ้าหนูก้มหน้าตอบไปว่า \"ไม่มีใครเชื่อฉันเลย เพราะฉันชอบโกหกพวกเค้า\" หลังเหตุการณ์วันนั้น เจ้าหนูรู้สึกเสียใจมาก เธอเข้าไปหาเพื่อน ๆ แล้วพูดว่า" },
                    { start: 158.0, end: 201.0, text: "\"เมื่อวานฉันเจองูจริง ๆ แต่ไม่มีใครเชื่อเลย ฉันรู้แล้วว่าการพูดไม่จริงทำให้เพื่อนไม่ไว้ใจ ฉันขอโทษนะ…\" เพื่อน ๆ มองหน้ากัน แล้วพูดว่า \"ถ้าเธอพูดความจริงแบบนี้ ต่อไปเราก็จะให้อภัย\" \"และเป็นเพื่อนกันเหมือนเดิม!\" เจ้าหนูยิ้มกว้าง สีหน้ามีความสุขขึ้นมาทันที ตั้งแต่นั้นมา เจ้าหนูก็พูดความจริงเสมอ ไม่แต่งเรื่องอีก และได้กลับมาเป็นเพื่อนรักกับทุกคนอีกครั้ง... นิทานเรื่องนี้สอนให้รู้ว่า. การพูดโกหกอาจดูสนุกในตอนแรก แต่ถ้าเราพูดไม่จริงบ่อย ๆ สุดท้ายจะไม่มีใครเชื่อเราเลย เพราะฉะนั้นเราควรพูดความจริงอยู่เสมอ" },
                    { start: 207.0, end: 222.0, text: "เพื่อให้คนไว้ใจและรักเรานะเด็กๆ... ติดตามนิทานเรื่องใหม่ๆ ได้ที่ช่อง \"บ้านนิทานเด็กดี\" และอย่าลืมกดติดตาม กดไลค์ กดแชร์ นิทานสนุกๆ ข้อคิดดีๆ ไว้ด้วยนะคร้าบบ..." }
                ],
                2: [
                    { start: 0.0, end: 47.0, text: "วันนี้เสนอตอน เจ้าหนูกับเรื่องไม่จริง ในหมู่บ้านสัตว์ตัวจิ๋ว มีหนูตัวเล็กน่ารัก มันมีนิสัยร่าเริงชอบเล่น ชอบพูด และบางทีก็ชอบแต่งเรื่องให้ดูน่าตื่นเต้น วันหนึ่ง เจ้าหนูวิ่งมาหาเพื่อน ๆ แล้วร้องว่า \"มาดูนี่เร็ว! ช้างบินได้! ฉันเห็นมันลอยอยู่บนฟ้า!\" เพื่อน ๆ ตกใจต่างพากันวิ่งมาดู \"จริงเหรอ?! ช้างบินได้เหรอ?!\" แต่มันไม่จริงเลย... เจ้าหนูหัวเราะ ฮ่าๆๆ และพูดขึ้นว่า \"ช้างที่ไหนจะบินได้ไม่มีหรอก..ฉันพูดเล่น\" เพื่อนๆ ต่างพากันบ่นเจ้าหนู แล้วแยกย้ายกันกลับบ้าน เช้าวันต่อมา เจ้าหนูเจอกับกระรอก แล้วบอกกระรอกไปว่า" },
                    { start: 55.0, end: 97.0, text: "ฉันมีชีสทองคำซ่อนไว้ใต้ดิน อย่าบอกใครนะ แต่ฉันจะให้เธอ! กระรอกดีใจมาก และขุดดินเพื่อที่จะหาชีสทองคำจนถึงเย็น แต่ก็หาไม่เจอสักที เจ้าหนูเดินผ่านกลับมาเจอแล้วถามว่า มาขุดอะไรที่นี่หรอ กระรอกตอบไปว่า ก็มาขุดชีสทองคำที่เธอบอกให้ฉันไง เจ้าหนูหัวเราะชอบใจและตอบไปว่า ฉันแค่ล้อเธอเล่น ไม่น่าคิดจริงจังเลย กระรอกได้ยินดังนั้นก็โกรธมาก และเดินจากไปไม่คุยกับเจ้าหนูต่อ หลายวันผ่านไป เพื่อน ๆ เริ่มไม่เชื่อสิ่งที่เจ้าหนูพูดแล้ว เธอชอบพูดไม่จริง... ใช่ ฟังแล้วก็ไม่รู้จะเชื่อดีไหม… แล้ววันหนึ่ง ตอนที่เจ้าหนูกำลังเล่นคนเดียวที่หลังพุ่มไม้" },
                    { start: 107.0, end: 148.0, text: "เธอเห็น งูตัวใหญ่ เลื้อยอยู่ใกล้มาก! เจ้าหนูตกใจสุดขีด \"งู! งู! ช่วยด้วย!!\" เธอร้องเสียงดังสุดเสียง แต่เพื่อน ๆ ได้ยินแล้วกลับพูดว่า \"คงแต่งเรื่องอีกแล้วแน่เลย…\" \"เราไม่อยากโดนเธอหลอกอีกแล้วล่ะ…\" ไม่มีใครมาช่วยเจ้าหนูเลย แต่โชคดีที่เจ้านกบินผ่านมาเจอพอดี จึงไล่งูให้ทันกันก่อนที่เจ้าหนูจะโดนกัด นกพูดว่า \"ปลอดภัยแล้วนะ\" \"แล้วทำไมไม่มีใครมาช่วยเธอเลยล่ะ เพื่อนก็อยู่กันตั้งเยอะ\" เจ้าหนูก้มหน้าตอบไปว่า \"ไม่มีใครเชื่อฉันเลย เพราะฉันชอบโกหกพวกเค้า\" หลังเหตุการณ์วันนั้น เจ้าหนูรู้สึกเสียใจมาก เธอเข้าไปหาเพื่อน ๆ แล้วพูดว่า" },
                    { start: 158.0, end: 201.0, text: "\"เมื่อวานฉันเจองูจริง ๆ แต่ไม่มีใครเชื่อเลย ฉันรู้แล้วว่าการพูดไม่จริงทำให้เพื่อนไม่ไว้ใจ ฉันขอโทษนะ…\" เพื่อน ๆ มองหน้ากัน แล้วพูดว่า \"ถ้าเธอพูดความจริงแบบนี้ ต่อไปเราก็จะให้อภัย\" \"และเป็นเพื่อนกันเหมือนเดิม!\" เจ้าหนูยิ้มกว้าง สีหน้ามีความสุขขึ้นมาทันที ตั้งแต่นั้นมา เจ้าหนูก็พูดความจริงเสมอ ไม่แต่งเรื่องอีก และได้กลับมาเป็นเพื่อนรักกับทุกคนอีกครั้ง... นิทานเรื่องนี้สอนให้รู้ว่า. การพูดโกหกอาจดูสนุกในตอนแรก แต่ถ้าเราพูดไม่จริงบ่อย ๆ สุดท้ายจะไม่มีใครเชื่อเราเลย เพราะฉะนั้นเราควรพูดความจริงอยู่เสมอ" },
                    { start: 207.0, end: 222.0, text: "เพื่อให้คนไว้ใจและรักเรานะเด็กๆ... ติดตามนิทานเรื่องใหม่ๆ ได้ที่ช่อง \"บ้านนิทานเด็กดี\" และอย่าลืมกดติดตาม กดไลค์ กดแชร์ นิทานสนุกๆ ข้อคิดดีๆ ไว้ด้วยนะคร้าบบ..." }
                ],
                3: [
                    { start: 0.0, end: 30.0, text: "Welcome to The Midnight Library. In a small town, there was a library that only opened between midnight and dawn. This wasn't an ordinary library - every book contained the story of a life you could have lived." },
                    { start: 30.0, end: 60.0, text: "Nora Seed, our protagonist, found herself at the lowest point in her life. She had lost her job, her cat had died, and her brother wasn't speaking to her. One night, feeling utterly hopeless, she decided to end it all." },
                    { start: 60.0, end: 90.0, text: "But instead of death, she woke up in the Midnight Library. The librarian, Mrs. Elm, her former school librarian, explained that this was a place between life and death where Nora could try out different lives through the books on the shelves." },
                    { start: 90.0, end: 120.0, text: "Each book represented a different life Nora could have lived if she had made different choices. She could have been a rock star, a glaciologist, a happily married woman with children, or even a pub owner in Australia." },
                    { start: 120.0, end: 150.0, text: "As Nora tried different lives, she discovered something profound: no life is perfect. Every choice comes with its own set of challenges and joys. The key wasn't finding the perfect life, but finding a life worth living." },
                    { start: 150.0, end: 180.0, text: "In the end, Nora realized that the life she had, with all its imperfections, was worth fighting for. She chose to return to her original life with a new perspective and appreciation for what she already had." }
                ],
                4: [
                    { start: 0.0, end: 35.0, text: "In the vast deserts of Arabia, under the endless sky filled with stars, lived a young Bedouin named Zaid. Every night, he would sit outside his tent, gazing at the stars, dreaming of adventures beyond the sand dunes." },
                    { start: 35.0, end: 70.0, text: "Zaid's grandfather, a wise old man with stories etched in every line of his face, would tell him tales of ancient astronomers who navigated the desert using only the stars. 'The stars are our compass, our calendar, and our storytellers,' he would say." },
                    { start: 70.0, end: 105.0, text: "One night, a strange star appeared in the sky - brighter than any they had seen before. The elders grew concerned, believing it to be an omen. But Zaid saw it as an invitation to explore." },
                    { start: 105.0, end: 140.0, text: "With his grandfather's blessing and guidance, Zaid began studying the stars more seriously. He learned to read their patterns, understanding when to plant crops, when to move camp, and how to find water in the most barren places." },
                    { start: 140.0, end: 175.0, text: "Years passed, and Zaid became the tribe's star reader. He used his knowledge not just for navigation, but to bring his people together, teaching children about the constellations and the stories behind them." },
                    { start: 175.0, end: 210.0, text: "The strange star that had once caused concern became a symbol of hope and knowledge. Zaid realized that sometimes the most extraordinary journeys begin with a single point of light in the darkness." }
                ],
                5: parseTimestampTranscript(rawTranscript) // Transkrip baru dari format timestamp
            };

            // Data audiobooks
            const audiobooks = [
                { 
                    id: 1, 
                    title: "Let it be", 
                    author: "John Lennon", 
                    cover: "https://images.unsplash.com/photo-1629992101753-56d196c8aabb?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=600&q=80",
                    audio: "https://cdn.baobaobook.org/transcripts/let%20it%20bee.mp3",
                    duration: "4h 22m" 
                },
                { 
                    id: 2, 
                    title: "บ้านนิทานเด็กดี", 
                    author: "Baan Nithan", 
                    cover: "https://images.unsplash.com/photo-1544947950-fa07a98d237f?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=600&q=80",
                    audio: "https://cdn.baobaobook.org/transcripts/%E0%B8%9A%E0%B9%89%E0%B8%B2%E0%B8%99%E0%B8%99%E0%B8%B4%E0%B8%97%E0%B8%B2%E0%B8%99%E0%B9%80%E0%B8%94%E0%B9%87%E0%B8%81%E0%B8%94%E0%B8%B5_%E0%B8%95%E0%B8%AD%E0%B8%99_%E0%B9%80%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%AB%E0%B8%99%E0%B8%B9%E0%B8%81%E0%B8%B1%E0%B8%9A%E0%B9%80%E0%B8%A3%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%87%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%88%E0%B8%A3%E0%B8%B4%E0%B8%87.mp3",
                    duration: "5h 45m" 
                },
                { 
                    id: 3, 
                    title: "The Midnight Library", 
                    author: "Matt Haig", 
                    cover: "https://images.unsplash.com/photo-1541963463532-d68292c34b19?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=600&q=80",
                    audio: "https://cdn.baobaobook.org/transcripts/Audiotes.mp3",
                    duration: "6h 17m" 
                },
                { 
                    id: 4, 
                    title: "Desert Stars", 
                    author: "Ahmed Al-Mansoori", 
                    cover: "https://images.unsplash.com/photo-1532012197267-da84d127e765?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=600&q=80",
                    audio: "https://cdn.baobaobook.org/transcripts/Audiotes.mp3",
                    duration: "7h 08m" 
                },
                { 
                    id: 5, 
                    title: "นิทานเด็กดี", 
                    author: "Baan Nithan", 
                    cover: "https://images.unsplash.com/photo-1544947950-fa07a98d237f?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=600&q=80",
                    audio: "https://cdn.baobaobook.org/transcripts/%E0%B8%9A%E0%B9%89%E0%B8%B2%E0%B8%99%E0%B8%99%E0%B8%B4%E0%B8%97%E0%B8%B2%E0%B8%99%E0%B9%80%E0%B8%94%E0%B9%87%E0%B8%80%E0%B8%94%E0%B8%B5_%E0%B8%95%E0%B8%AD%E0%B8%99_%E0%B9%80%E0%B8%88%E0%B9%89%E0%B8%B2%E0%B8%AB%E0%B8%99%E0%B8%B9%E0%B8%80%E0%B8%B1%E0%B8%9A%E0%B9%80%E0%B8%A3%E0%B8%B7%E0%B9%88%E0%B8%AD%E0%B8%87%E0%B9%84%E0%B8%A1%E0%B9%88%E0%B8%88%E0%B8%A3%E0%B8%B4%E0%B8%87.mp3",
                    duration: "3m 36s" 
                }
            ];

            // DOM Elements
            const elements = {
                audio: document.getElementById('audio-element'),
                textDisplay: document.getElementById('text-display'),
                playPauseBtn: document.getElementById('play-pause-btn'),
                prevBtn: document.getElementById('prev-btn'),
                nextBtn: document.getElementById('next-btn'),
                rewindBtn: document.getElementById('rewind-btn'),
                forwardBtn: document.getElementById('forward-btn'),
                audiobookCards: document.getElementById('audiobook-cards'),
                audiobookForm: document.getElementById('audiobook-form'),
                progressBar: document.getElementById('progress-bar'),
                progressContainer: document.getElementById('progress-container'),
                currentTimeEl: document.getElementById('current-time'),
                durationEl: document.getElementById('duration'),
                bookCover: document.getElementById('book-cover'),
                currentBookTitle: document.getElementById('current-book-title'),
                currentBookAuthor: document.getElementById('current-book-author'),
                scrollLeftBtn: document.getElementById('scroll-left'),
                scrollRightBtn: document.getElementById('scroll-right')
            };

            // Player state
            let currentBookIndex = 0;
            let isPlaying = false;

            // Render transcript
            function renderTranscript() {
                const transcript = transcripts[currentBookIndex + 1] || [];
                const textHTML = transcript.map(fragment =>
                    `<p class="transcript-sentence" data-start="${fragment.start}" data-end="${fragment.end}">${fragment.text}</p>`
                ).join('');
                elements.textDisplay.innerHTML = textHTML;
            }

            // Render audiobook cards dynamically
            function renderAudiobookCards() {
                const cardsHTML = audiobooks.map((book, index) => `
                    <div class="card" data-index="${index}">
                        <img src="${book.cover}" alt="${book.title}" class="card-img">
                        <div class="card-content">
                            <h3 class="card-title">${book.title}</h3>
                            <p class="card-author">By ${book.author}</p>
                            <div class="card-duration">
                                <span><i class="fas fa-headphones"></i> Audiobook</span>
                                <span>${book.duration}</span>
                            </div>
                        </div>
                    </div>
                `).join('');
                elements.audiobookCards.innerHTML = cardsHTML;
            }

            // Handle player state changes
            function togglePlayPause() {
                if (isPlaying) {
                    elements.audio.pause();
                } else {
                    elements.audio.play();
                }
                isPlaying = !isPlaying;
                updatePlayButtonIcon();
            }

            function updatePlayButtonIcon() {
                const icon = elements.playPauseBtn.querySelector('i');
                icon.className = isPlaying ? 'fas fa-pause' : 'fas fa-play';
            }

            // Set up event listeners
            function setupEventListeners() {
                // Play/Pause button
                elements.playPauseBtn.addEventListener('click', togglePlayPause);

                // Previous/Next buttons
                elements.prevBtn.addEventListener('click', () => {
                    currentBookIndex = (currentBookIndex - 1 + audiobooks.length) % audiobooks.length;
                    loadAudiobook(currentBookIndex);
                });

                elements.nextBtn.addEventListener('click', () => {
                    currentBookIndex = (currentBookIndex + 1) % audiobooks.length;
                    loadAudiobook(currentBookIndex);
                });
                
                // Rewind/Forward buttons
                elements.rewindBtn.addEventListener('click', () => {
                    if (!isNaN(elements.audio.currentTime)) {
                        elements.audio.currentTime = Math.max(0, elements.audio.currentTime - 10);
                    }
                });
                
                elements.forwardBtn.addEventListener('click', () => {
                    if (!isNaN(elements.audio.currentTime) && !isNaN(elements.audio.duration)) {
                        elements.audio.currentTime = Math.min(elements.audio.duration, elements.audio.currentTime + 10);
                    }
                });

                // Scroll buttons for cards
                elements.scrollLeftBtn.addEventListener('click', () => {
                    elements.audiobookCards.scrollBy({ left: -270, behavior: 'smooth' });
                });

                elements.scrollRightBtn.addEventListener('click', () => {
                    elements.audiobookCards.scrollBy({ left: 270, behavior: 'smooth' });
                });

                // Card clicks to change audiobooks
                elements.audiobookCards.addEventListener('click', (e) => {
                    const card = e.target.closest('.card');
                    if (card) {
                        const index = parseInt(card.getAttribute('data-index'));
                        if (index !== currentBookIndex) {
                            currentBookIndex = index;
                            loadAudiobook(currentBookIndex);
                        }
                    }
                });
                
                // Progress bar seeking
                elements.progressContainer.addEventListener('click', (e) => {
                    const rect = elements.progressContainer.getBoundingClientRect();
                    const clickX = e.clientX - rect.left;
                    const width = rect.width;
                    const duration = elements.audio.duration;
                    if (!isNaN(duration) && duration > 0) {
                        elements.audio.currentTime = (clickX / width) * duration;
                    }
                });

                // Update progress bar and time display
                elements.audio.addEventListener('timeupdate', () => {
                    const currentTime = elements.audio.currentTime;
                    const duration = elements.audio.duration;
                    if (!isNaN(duration) && duration > 0) {
                        const progressPercent = (currentTime / duration) * 100;
                        elements.progressBar.style.width = `${progressPercent}%`;
                        elements.currentTimeEl.textContent = formatTime(currentTime);
                        elements.durationEl.textContent = formatTime(duration);
                        highlightText(currentTime);
                    }
                });

                // Handle audio end
                elements.audio.addEventListener('ended', () => {
                    isPlaying = false;
                    updatePlayButtonIcon();
                });

                // Form submission
                elements.audiobookForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    showStatusMessage('Thank you for your request! We will consider adding this audiobook to our collection.', 'success');
                    elements.audiobookForm.reset();
                });
            }

            // Format time in minutes and seconds
            function formatTime(seconds) {
                if (isNaN(seconds) || seconds < 0) return '0:00';
                
                const mins = Math.floor(seconds / 60);
                const secs = Math.floor(seconds % 60);
                return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
            }

            // Highlight text based on current time
            function highlightText(currentTime) {
                const paragraphs = elements.textDisplay.querySelectorAll('.transcript-sentence');
                let found = false;
                paragraphs.forEach(p => {
                    const start = parseFloat(p.getAttribute('data-start'));
                    const end = parseFloat(p.getAttribute('data-end'));
                    const isCurrent = !isNaN(start) && !isNaN(end) && 
                                    currentTime >= start && currentTime < end;
                    p.classList.toggle('highlight', isCurrent);
                    if (isCurrent && !found) {
                        p.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        found = true;
                    }
                });
            }

            // Show a temporary status message
            function showStatusMessage(message, type = 'info') {
                const statusDiv = document.createElement('div');
                statusDiv.className = `status-message ${type}`;
                statusDiv.style.background = 'rgba(76, 175, 80, 0.15)';
                statusDiv.style.borderLeft = '4px solid #4CAF50';
                statusDiv.style.padding = '12px';
                statusDiv.style.borderRadius = '6px';
                statusDiv.style.margin = '15px 0';
                statusDiv.style.textAlign = 'center';
                statusDiv.textContent = message;
                elements.audiobookForm.parentNode.insertBefore(statusDiv, elements.audiobookForm);
                setTimeout(() => statusDiv.remove(), 5000);
            }

            // Load audiobook data
            function loadAudiobook(index) {
                const book = audiobooks[index];
                if (!book) return;

                // Update UI elements
                elements.currentBookTitle.textContent = book.title;
                elements.currentBookAuthor.textContent = `By ${book.author}`;
                elements.bookCover.src = book.cover;
                elements.audio.src = book.audio;
                
                // Tampilkan transkrip yang sudah di-embed
                renderTranscript();
                
                // Restart playback from beginning if a new book is loaded
                if (isPlaying) {
                    elements.audio.play();
                } else {
                    elements.audio.load();
                }
            }

            // Initialize the player
            function initPlayer() {
                renderAudiobookCards();
                loadAudiobook(currentBookIndex);
                setupEventListeners();
            }

            // Start the application
            initPlayer();
        });
    </script>
</body>
</html>
